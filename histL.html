<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>histL — лекции</title>
<style>
:root{ --gap:14px; --accent:#ff6b6b; --bg:#0d0f12; }
*{box-sizing:border-box}
body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin:0; background:var(--bg); color:#eef2ff}
.wrap{max-width:1200px; margin:20px auto; padding:18px}
.gallery{display:grid; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); gap:var(--gap);}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12)); border-radius:12px; overflow:hidden; box-shadow:0 6px 18px rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; cursor:pointer; transition:transform .18s ease, box-shadow .18s ease; height:80px; padding:12px;}
.card:hover{transform:translateY(-6px); box-shadow:0 12px 28px rgba(0,0,0,0.7);}
.play-btn{background:linear-gradient(90deg,var(--accent),#ff9a9a); color:#12070a; border:none; border-radius:8px; padding:8px 12px; font-size:1rem; cursor:pointer; width:100%; text-align:center;}
.modal{display:none; position:fixed; inset:0; z-index:9999; align-items:center; justify-content:center; background:rgba(0,0,0,0.9); padding:20px}
.modal.open{display:flex}
.viewer{max-width:90%; width:100%; max-height:92vh; display:flex; align-items:center; justify-content:center; position:relative}
.viewer .photo{flex:1; display:flex; align-items:center; justify-content:center;}
.viewer img{max-width:100%; max-height:92vh; display:block; border-radius:10px; box-shadow:0 0 30px rgba(0,0,0,0.6);}
.modal .close{position:absolute; top:18px; right:22px; background:transparent; border:none; color:#fff; font-size:1.8rem; cursor:pointer}
.nav{position:absolute; top:50%; transform:translateY(-50%); background:rgba(255,255,255,0.03); border:none; color:#fff; font-size:2.2rem; width:56px; height:64px; cursor:pointer; display:flex; align-items:center; justify-content:center; border-radius:10px;}
.nav.left{left:18px}
.nav.right{right:18px}
button[disabled]{opacity:.35; pointer-events:none}
.details{display:none}
@media (max-width:420px){
  .wrap{padding:12px}
  .nav{width:44px; height:56px; font-size:1.6rem}
  .card{height:70px; padding:8px;}
  .play-btn{font-size:.9rem;}
}
</style>
</head>
<body>
<div class="wrap">
  <div class="gallery" id="gallery" aria-label="Список лекций"></div>
</div>

<div id="modal" class="modal" aria-hidden="true">
  <button class="nav left" id="prev" aria-label="Предыдущая">‹</button>
  <div class="viewer" role="dialog" aria-modal="true">
    <div class="photo"><img id="modalImg" src="" alt=""></div>
  </div>
  <button class="nav right" id="next" aria-label="Следующая">›</button>
  <button class="close" id="closeBtn" aria-label="Закрыть">×</button>
</div>

<script>
const lectures = [
  {title:'Лекция 1 — Древнерусское государство', images:['assets/img/his1.jpeg','assets/img/his2.jpeg','assets/img/his3.jpeg', 'assets/img/his4.jpeg','assets/img/his5.jpeg','assets/img/his6.jpeg']},
];

const gallery = document.getElementById('gallery');
lectures.forEach((lec, lidx)=>{
  const card = document.createElement('article');
  card.className='card';
  card.innerHTML = `<button class="play-btn" data-lecture="${lidx}" aria-label="${lec.title}">${lec.title}</button>`;
  gallery.appendChild(card);
});

const modal = document.getElementById('modal');
const modalImg = document.getElementById('modalImg');
const closeBtn = document.getElementById('closeBtn');
const prevBtn = document.getElementById('prev');
const nextBtn = document.getElementById('next');

let currentLecture = 0;
let currentIndex = 0;

function renderModal(){
  const lec = lectures[currentLecture];
  modalImg.src = lec.images[currentIndex];
  modalImg.alt = lec.title + ' — страница ' + (currentIndex+1);
  prevBtn.toggleAttribute('disabled', currentIndex===0);
  nextBtn.toggleAttribute('disabled', currentIndex===lec.images.length-1);
}

function openModal(lectureIndex, startIndex=0){
  currentLecture = lectureIndex;
  currentIndex = startIndex;
  renderModal();
  modal.classList.add('open');
  modal.setAttribute('aria-hidden','false');
  document.body.style.overflow='hidden';
  nextBtn.focus();
}

function closeModal(){
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden','true');
  document.body.style.overflow='';
  const btn = gallery.querySelector(`[data-lecture="${currentLecture}"]`);
  if(btn) btn.focus();
}

function showNext(delta){
  const len = lectures[currentLecture].images.length;
  let next = currentIndex+delta;
  if(next<0) next=0;
  if(next>=len) next=len-1;
  currentIndex=next;
  renderModal();
}

gallery.addEventListener('click', e=>{
  const btn = e.target.closest('[data-lecture]');
  if(!btn) return;
  const lecIdx = Number(btn.getAttribute('data-lecture'));
  openModal(lecIdx,0);
});

document.addEventListener('keydown', e=>{
  if(modal.classList.contains('open')){
    if(e.key==='ArrowRight') showNext(1);
    if(e.key==='ArrowLeft') showNext(-1);
    if(e.key==='Escape') closeModal();
  }
});

prevBtn.addEventListener('click', ()=>showNext(-1));
nextBtn.addEventListener('click', ()=>showNext(1));
closeBtn.addEventListener('click', closeModal);
modal.addEventListener('click', e=>{if(e.target===modal) closeModal();});

// свайпы
(function(){
  let sx=0,sy=0;
  const photo = modal.querySelector('.photo');
  photo.addEventListener('touchstart', e=>{ const t=e.changedTouches[0]; sx=t.clientX; sy=t.clientY; });
  photo.addEventListener('touchend', e=>{ const t=e.changedTouches[0]; const dx=t.clientX-sx; const dy=t.clientY-sy;
    if(Math.abs(dx)>40 && Math.abs(dx)>Math.abs(dy)){
      if(dx<0) showNext(1);
      if(dx>0) showNext(-1);
    }
  });
})();
</script>
</body>
</html>
